<?php  $q_id= $this->uri->slash_segment(3);  $split=split('/',$q_id);  $quotation_id=$split[0];      $result=$this->backend_model->get_quotation_details($quotation_id);    $user_data=$this->backend_model->get_user_details($result->customer_id);    $surface_framer=$this->backend_model->get_framer_surface('FRM');$surface_mount=$this->backend_model->get_framer_surface('MNT');$surface_glass=$this->backend_model->get_framer_surface('GLS');?><html><head>    <title>Create Quotation</title>    <link href="<?php echo base_url()?>assets/css/jquery-ui-1.10.4.custom.css" rel="stylesheet">    <script src="<?php echo base_url()?>assets/js/jquery-1.10.2.js"></script>    <script src="<?php echo base_url()?>assets/js/jquery-ui-1.10.4.custom.js"></script>    <script src="<?php echo base_url()?>assets/js/common.js"></script>                <style>                    .txtbox{ width: 61px; height: 30px;}                    </style>        <!-- FOR SHOW HIDE TABLES-->     <link rel="stylesheet" href="<?=base_url()?>assets/css/bootstrap.min.css">  <link rel="stylesheet" href="<?=base_url()?>assets/css/bootstrap-select.css"> <link rel="stylesheet" type="text/css" href="<?=base_url()?>assets/css/anylinkmenu.css" /><script type="text/javascript" src="<?=base_url()?>assets/js/menucontents.js"></script><script type="text/javascript" src="<?=base_url()?>assets/js/anylinkmenu.js"></script><script type="text/javascript" src="<?=base_url()?>assets/js/jquery-1.6.1.min.js"></script>  <script src="<?=base_url()?>assets/js/jquery.min2.js"></script>  <script src="<?=base_url()?>assets/js/bootstrap.min.js"></script>  <script src="<?=base_url()?>assets/js/bootstrap-select.js"></script> </head><body><!--MIDDLE PAGE WRAPPER STARTS--><div id="middle-wrapper"><div id="middle-container"> <div class="main-hdr-quotation"> Edit Quotation</div><div id="quotationListDiv" class="manage-order" >    <form  name="edit_quotation_form" action="<?=base_url()?>index.php/quotation/edit_quotation_save" method="post" >        <input type="hidden" name="quotation_id" value="<?=$quotation_id?>">      <b  style=" font-size: 14px; color: green;"><?php if($msg<>'') {?>          <script>              setTimeout(function(){outtime()},3000);              function outtime(){                  window.location.href="edit_quotation_detail/<?=$quotation?>";              }           </script>          <?php echo $msg;}?></b><br><br>  <table width="100%" cellpadding="0" cellspacing="0" class="creat-ordertable">  <tr  class="darktr">    <td width="18%" class="bold">Quotation ID:</td>    <td>    <?=$quotation_id?>       </td>    </tr>      <div>  <tr>    <td colspan="2" style="padding:0;">        <div class="quotation-div"  id="quotation2Div" style="margin-left:0px" ><!--DETAILS TABLE--> <div style="background:#388fc4; font-size:16px; color:#fff; padding:8px; "> Customer Details</div>    <table width="100%" border="0" cellspacing="0" cellpadding="0">      <tr class="darktr">    <td width="150" class="bold">First Name:</td>    <td> <input type="text" id ="firstname" name="firstname" value="<?=$user_data->first_name?>" readonly style="background-color: #eee; border: none;"></td>    <td class="bold">Last Name:</td>    <td><input type="text" id ="lastname" name="lastname" value="<?=$user_data->first_name?>" readonly style="background-color: #eee; border: none;"></span></td>  </tr>  <tr>    <td class="bold">Email Id:</td>    <td><input type="text" id ="email" name="email" value="<?=$user_data->email_id?>" readonly style="background-color:#F7F7F7; border: none;"></td>    <td class="bold">Occupation</td>    <td><input type="text" id ="occupation" value="<?=$user_data->occupation_other?>" name="occupation" readonly style="background-color: #F7F7F7; border: none;"></td>  </tr>  <tr>    <td class="bold">Address:</td>    <td><input type="text" id ="address" name="address" value="<?=$user_data->address?>" ></td>    <td class="bold">Company Name</td>    <td><input type="text" id ="companyname" value="<?=$user_data->company_name?>" name="companyname" ></td>  </tr>    <tr class="darktr">    <td class="bold">Country</td>    <td><input type="text" id ="country" value="<?=$user_data->country?>" name="country" ></td>    <td class="bold">State</td>    <td><input type="text" id ="state" value="<?=$user_data->state?>" name="state" ></td>  </tr>  <tr>    <td class="bold">City</td>    <td><input type="text" id ="city" value="<?=$user_data->city?>" name="city"></td>    <td  class="bold">Region</td>        <td><input type="text" id ="region" value="<?=$user_data->customers_region?>" name="region" ></td>  </tr>  <tr class="darktr">    <td class="bold">Pin Code</td>    <td><input type="text" id ="pincode" value="<?=$user_data->zip_code?>" name="pincode" ></td>    <td class="bold">Contact Number</td>    <td><input type="text" id ="contactnumber" value="<?=$user_data->contact?>" name="contactnumber" ></td>  </tr>      </table>    <div style="background:#388fc4; font-size:16px; color:#fff; padding:8px; margin-top:25px "> Order Summary</div>     </div>    </td>    </tr>      <tr style="border-bottom:none" >    <td colspan="2" >            <div class="viewcplist-inner">              <table   border="0" cellspacing="0" cellpadding="0" >        <tr class="hdrs">                   <td>Image Id</td>          <td>Visual</td>          <td>License Cost</td>          <td colspan="4">Print</td>          <td colspan="3">Mount</td>          <td colspan="3">Frame</td>         <td colspan="2">Cover</td>          <td><strong>Total</strong></td>                            </tr>        <tr class="hdrs">                    <td>&nbsp;</td>           <td>&nbsp;</td>            <td>&nbsp;</td>           <td>Surface</td>            <td>Code</td>          <td>Height</td>          <td> Width</td>                    <td>Print Cost</td>           <td> Code</td>           <td>Width</td>                               <td>Mount Cost</td>        <td>Frame Code</td>          <td>Frame Cost</td>        <td>Glass</td>         <td>Glass Cost</td>          <td></td>        </tr>         <?php           $quotation=$this->backend_model->get_edit_quotation_details($quotation_id);          //print_r($quotation);          $i=0;           foreach($quotation as $qc_values){               $items=count($quotation);              // echo $qc_values->frame_code         ?>          <input type="hidden" name="edit_id[]" value="<?=$qc_values->id?>">              <tr> <td><input type="text" onblur="return show_image_visual<?=$i?>(this.value);" class="txtbox" name="imgid[]" value="<?=$qc_values->image_id?>" id="imgid" /></td>                  <td><span id="image_visual<?=$i?>"><img src="<?php echo "http://www.indiapicture.in/wallsnart/398/".$qc_values->image_id."";?>" height="80px;" width="80px;"></span></td>              <td><input type="text" class="txtbox" value="<?=$qc_values->licence_cost?>" name="license_cost[]" onblur="return calculator_show();" id="license_cost<?=$i;?>"  /></td>            <td><select name="surface[]"  id="surface"> <?php $surface=$this->backend_model->get_surface(); foreach($surface as $surf) {  ?>             <option value="<?php echo $surf['surface']; ?>" <?php if($qc_values->surface==$surf['surface']) {?> selected="" <?php }?>><?php echo $surf['surface'] ?></option><?php } ?> </select></td>             <td><input type="text" value="<?=$qc_values->print_size_height?>" name="print_height[]" id="print_height<?=$i;?>" class="txtbox" onblur="return calculator_show();"></td>            <td><input type="text" value="<?=$qc_values->print_size_width?>" name="print_width[]" id="print_width<?=$i;?>" onblur="return calculator_show();" class="txtbox"></td>            <td><input type="tex"  value="<?=$qc_values->print_cost?>" readonly="" name="print_cost[]" id="print_cost<?=$i;?>" class="txtbox" ></td>            <td><select name="mount_code[]" id="mount_code0"> <?php foreach ($surface_mount as $mount) {  ?>                    <option <?php if($qc_values->mount_code==$mount['surface']){?>selected=""<?php }?> value="<?php echo $mount['surface']; ?>"><?php echo $mount['surface'] ?></option><?php } ?> </select></td>            <td><input type="text" value="<?=$qc_values->mount_size_width?>" name="mount_width[]" id="mount_width<?=$i;?>" onblur="return calculator_show();" class="txtbox"></td>           <td><input type="tex" value="<?=$qc_values->mount_cost?>" readonly="" name="mount_cost[]" id="mount_cost<?=$i;?>" class="txtbox" ></td>           <td><select name="frame_code[]" id="framer_code0"> <?php foreach ($surface_framer as $framer) {  ?>                   <option <?php if($qc_values->frame_code==$framer['surface']){?> selected=""<?php }?> value="<?php echo $framer['surface']; ?>"><?php echo $framer['surface'] ?></option><?php } ?> </select></td>                <td><input type="text" value="<?=$qc_values->frame_size_width?>" name="frame_width[]" id="frame_width<?=$i;?>" onblur="return calculator_show();" class="txtbox"></td>           <td><input type="tex" value="<?=$qc_values->frame_cost?>" readonly="" name="frame_cost[]" id="frame_cost<?=$i;?>" class="txtbox" ></td>           <td><select name="cover[]" id="surface0"> <?php foreach ($surface_glass as $GLASS) {  ?>                   <option <?php if($qc_values->surface==$GLASS['surface']){?>selected=""<?php }?> value="<?php echo $GLASS['surface']; ?>"><?php echo $GLASS['surface'] ?></option><?php } ?> </select></td>                      <td><input type="tex" value="<?=$qc_values->glass_cost?>"  readonly="" name="glass_cost[]" id="glass_cost<?=$i;?>" class="txtbox" ></td>           <td ><input type="text" value="<?=$qc_values->total?>"  readonly="" style="background-color:#F7F7F7; text-align: center; font: bold; border: none;" name="Q_total[]" id="total<?=$i;?>"></td></tr>                         <script>                  function show_image_visual<?=$i?>(image_id)                   {                       //alert(image_id);                      $.ajax({                         type:'post',                         url:'edit_show_images_viusal',                         data:'image_id='+image_id,                         success:function(response)                         {                             alert(response);                                                                                     var a = document.createElement("img");                            a.src = response;                            a.height = 80;                            a.width = 80;                                                         $('#image_visual<?=$i?>').html(a);                         }                                                });                   }// end function                                      </script>               <?php          $final_total+=$qc_values->total;         $after_discount+=$qc_values->after_discount;                    $i++; }?>      </table>    </div>                <p>&nbsp;</p>        <br />    <br />    <table width="600" border="0" cellspacing="0" cellpadding="0">        <tr>    <td class="bold">Packaging Charges:</td>    <td><input type="text" name="packaging_charge" readonly="" id="packaging_charge" value="<?=$result->packing_charge?>" class="txtbox"> </td>    </tr>  <tr class="darktr">    <td class="bold">Courier Charges:</td>    <td><input type="text" name="courier_charge"  readonly="" id="courier_charge" value="<?=$result->courier_charge?>"  class="txtbox"></td>    </tr>  <tr>    <td class="bold">Discount:</td>    <td><input type="text" name="discount"  id="discount" value="<?=$result->discount?>" class="txtbox" onblur="return calculate_discount();"></td>    </tr>    <tr class="darktr">    <td class="bold">Total After Discount:</td>    <td><input type="text" name="after_discount" readonly="" value="<?=$after_discount?>" id="after_discount" class="txtbox"></td>    </tr>  <tr>    <td class="bold">Tax - 5% VAT:</td>    <td><input type="text" readonly="" name="tax" value="<?=$result->tax?>" class="txtbox"></td>    </tr>         <tr class="darktr">    <td class="bold">Final Amount:</td>    <td class="total-price"><div >            <?php                        function formatMoney($number, $fractional=false) {     if ($fractional) {         $number = sprintf('%.2f', $number);     }     while (true) {         $replaced = preg_replace('/(-?\d+)(\d\d\d)/', '$1,$2', $number);         if ($replaced != $number) {             $number = $replaced;         } else {             break;         }     }     return $number; }             ?>            <input type="hidden" readonly=""  style="background-color:#08558d; font: bold; border: none;" name="finalTotal_txt" id="Total_txt_amount" value="">            <input type="text" readonly=""  style="background-color:#08558d; font: bold; border: none;" name="finalTotal_txt" id="finalTotal_txt" value="<?php echo formatMoney($final_total);?>"></div></td>    </tr>    </table>        <br /> <br /> <br />    <table width="1000" border="0" cellspacing="0" cellpadding="0">      <tr class="darktr">        <td width="150" class="bold">Sales Person:</td>        <td><input type="text" name="s_name" value="<?=$result->sales_person?>" id="name-" placeholder="Name"/></td>        <td><input type="text" name="s_email" value="<?=$result->sales_emailid?>" id="name-2" placeholder="Email"/></td>        <td><input type="text" name="s_contact" value="<?=$result->sales_contact?>" id="name-3" placeholder="Contact Number"/></td>      </tr>      <tr>        <td class="bold">Client Servicing:</td>        <td><input type="text" name="c_name"  value="<?=$result->client_servicing?>" id="name-4" placeholder="Name"/></td>        <td><input type="text" name="c_email" value="<?=$result->client_emailid?>" id="name-5" placeholder="Email"/></td>        <td><input type="text" name="c_contact" value="<?=$result->client_contact?>" id="name-6" placeholder="Contact Number"/></td>      </tr>      <tr class="darktr">        <td class="bold">Updated by:</td>        <td><input type="text" name="createdby" value="<?=$result->createdby?>" id="name-7" placeholder="Name"/></td>        <td>&nbsp;</td>        <td>&nbsp;</td>      </tr>          </table>    </td>    </tr>    </div>  </table>              <div style="padding:30px; text-align:left">   <input type="submit" name="addcpn" id="addcpn" value="Edit_Quotation" class="bt-create-quote" >   <input type="submit" name="addcpn2" id="addcpn2" value="Convert to Invoice" class="bt-create-quote" style="background:#333399"/></div></form></div></div><div style="margin:100px 0 25px 40px"><a href="javascript:window.history.back()" class="bt-back"> Back </a></div></div></body></html><script>    function calculate_discount()  {   var discount=$('#discount').val();    var finalTotal_txt=$('#Total_txt_amount').val();   // alert(discount+'_'+finalTotal_txt);   var dis_val=parseFloat(finalTotal_txt*discount/100);   var after_discount=parseFloat(finalTotal_txt-dis_val);//   /alert(after_discount);   $('#after_discount').val(after_discount);  }      </script>